# 下载二进制版本（推荐新手使用）

如果你不懂代码或不想安装Python环境，可以直接下载预编译的二进制程序：

1. 前往 [Releases 页面](https://github.com/gasdyueer/pdf_bm_tools/releases)
2. 下载最新版本的 `pdf_bm_tools.exe` 文件（版本 v1.0）
3. 下载完成后，双击 `pdf_bm_tools.exe` 文件即可运行程序
4. 无需安装任何依赖，直接使用所有功能

**注意事项：**
- 二进制版本可能不是最新功能，请定期检查新版本
- 如果遇到杀毒软件误报，请允许运行（这是开源软件，不会危害您的电脑）

---

# PDF书签工具

基于PySide6和PyMuPDF的PDF处理工具。

## 功能特性

1. **PDF文件选择和基本信息读取** - 可以选择PDF文件并显示基本信息
2. **页面提取功能** - 支持提取指定页面范围保存为新PDF
3. **书签文件解析** - 支持解析多种格式的书签TXT文件
4. **AI提示词提示** - 提供AI生成书签文件的提示词

## 使用说明

1. 下载并运行程序（推荐方法）- 按照上方"下载二进制版本"说明下载exe文件并运行

2. 选择PDF文件 - 点击"选择PDF文件"按钮选择要处理的PDF文件

3. 查看PDF信息 - 选择文件后会自动显示PDF的基本信息

4. 提取页面 - 在页面提取输入框中输入页面范围（如：1-5,8,10-12），然后点击"提取页面"

5. 应用书签 - 选择书签TXT文件，然后点击"应用书签"

6. 查看AI提示词 - 点击"查看AI提示词"按钮获取生成书签文件的提示词

## 新手引导（使用测试文件）

如果你是第一次使用本工具，建议按照以下步骤使用项目中的测试文件进行练习：

### 准备测试文件

项目中的 `test_files` 文件夹包含了测试用的文件：
- `test.pdf`: 测试PDF文件（14页）
- `text.txt`: 对应的书签文件（格式：章节标题 (页码)，缩进表示层级）

### 操作步骤

1. **运行程序** - 下载并运行 `pdf_bm_tools.exe`

2. **选择PDF文件** - 点击"选择PDF文件"按钮，选择项目中的 `test_files/test.pdf` 文件

3. **查看PDF信息** - 选择文件后，程序会自动显示PDF的基本信息（页数、文件大小等）

4. **应用书签** - 点击"选择书签TXT文件"按钮，选择项目中的 `test_files/text.txt` 文件
   - **重要提示**：测试PDF的前3页是空页或过渡页，实际内容从第4页开始。如果书签页码没有对准内容，请在"偏移页码"输入框中填写4（设置为实际内容开始的页码）
   - 然后点击"应用书签"

5. **验证结果** - 书签应用成功后，用PDF阅读器打开 `test.pdf`，查看左侧书签栏是否出现了正确的章节结构

6. **尝试其他功能** - 可以尝试页面提取功能，比如输入"4-6"来提取实际内容的第1-3页保存为新PDF

### 预期结果

应用书签后，PDF的书签栏应该显示：
```
第一章 本指南概述入门知识
第二章 本章讲解核心原理
  2.1 理解基本概念的重要性
    2.1.1 定义基本概念的含义
    2.1.2 分类基本概念的方法
  2.2 掌握关键理论的要点
  ...
```

**特别提醒**：
- 测试PDF是从Markdown文件生成的，前3页是空页或过渡页
- 书签文件中的页码是从第1页开始计数，但实际内容在第4页
- 如果书签没有对准正确位置，请在"偏移页码"输入框中填写4（直接设置为实际内容开始的页码）
- 这是PDF书签工具最重要的一项功能：处理页码偏移问题

## 书签文件格式

支持以下格式：

### 格式1（推荐）：
```
1|第一章 引言|1
1|第二章 基础知识|5
2|2.1 基本概念|5
2|2.2 重要定理|8
1|第三章 高级主题|12
```

### 格式2：
```
第一章 引言 (1)
第二章 基础知识 (5)
  2.1 基本概念 (5)
  2.2 重要定理 (8)
第三章 高级主题 (12)
```

### 格式3（缩进表示层级）：
```
第一章 引言
  1.1 基本概念
    1.1.1 详细说明
  1.2 重要定理
第二章 高级主题
```

## 注意事项

- 页面号从1开始计数
- 书签层级从1开始，1表示顶级
- 目前书签设置功能可能需要根据PyMuPDF版本进行调整

---

## 开发者信息

**如果你不懂代码，可以忽略这部分内容。以下是为有编程基础的用户准备的开发相关信息。**

### 安装依赖

```bash
pip install PySide6 PyMuPDF
```

### 源码运行

运行程序：
```python
python main.py
```

### 开发状态

✅ 已完成：
- GUI界面设计
- PDF文件选择和信息读取
- 页面提取功能
- 书签文件解析
- AI提示词提示

